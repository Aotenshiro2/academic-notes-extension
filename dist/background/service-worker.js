function a(){setInterval(()=>{chrome.runtime.getPlatformInfo()},2e4)}chrome.runtime.onStartup.addListener(()=>{a()});chrome.runtime.onInstalled.addListener(()=>{console.log("Academic Notes Extension installed"),c(),a()});function c(){chrome.contextMenus.removeAll(()=>{chrome.contextMenus.create({id:"open-sidebar",title:"Ouvrir Academic Notes",contexts:["page"]}),chrome.contextMenus.create({id:"capture-page",title:"Capturer cette page",contexts:["page"]})})}chrome.contextMenus.onClicked.addListener(async(r,e)=>{if(e!=null&&e.id)switch(r.menuItemId){case"open-sidebar":await chrome.sidePanel.open({tabId:e.id});break;case"capture-page":await chrome.tabs.sendMessage(e.id,{type:"CAPTURE_PAGE"});break}});chrome.commands.onCommand.addListener(async(r,e)=>{if(e!=null&&e.id)switch(r){case"toggle-sidebar":await chrome.sidePanel.open({tabId:e.id});break;case"quick-capture":await chrome.tabs.sendMessage(e.id,{type:"CAPTURE_PAGE"});break}});chrome.action.onClicked.addListener(async r=>{r.id&&await chrome.sidePanel.open({tabId:r.id})});chrome.runtime.onMessage.addListener((r,e,t)=>(s(r,e,t),!0));async function s(r,e,t){try{switch(r.type){case"CAPTURE_SCREENSHOT":const n=await chrome.tabs.captureVisibleTab();t({success:!0,dataUrl:n});break;default:t({error:"Unknown message type"})}}catch{t({error:"Error processing message"})}}a();
