function n(){setInterval(()=>{chrome.runtime.getPlatformInfo()},2e4)}chrome.runtime.onStartup.addListener(()=>{console.log("Academic Notes Extension started"),n()});chrome.runtime.onInstalled.addListener(()=>{console.log("Academic Notes Extension installed"),c(),n()});function c(){chrome.contextMenus.removeAll(()=>{chrome.contextMenus.create({id:"open-sidebar",title:"Ouvrir Academic Notes",contexts:["page"]}),chrome.contextMenus.create({id:"capture-page",title:"Capturer cette page",contexts:["page"]})})}chrome.contextMenus.onClicked.addListener(async(t,e)=>{if(e!=null&&e.id)switch(t.menuItemId){case"open-sidebar":await chrome.sidePanel.open({tabId:e.id});break;case"capture-page":await chrome.tabs.sendMessage(e.id,{type:"CAPTURE_PAGE"});break}});chrome.commands.onCommand.addListener(async(t,e)=>{if(e!=null&&e.id)switch(t){case"toggle-sidebar":await chrome.sidePanel.open({tabId:e.id});break;case"quick-capture":await chrome.tabs.sendMessage(e.id,{type:"CAPTURE_PAGE"});break}});chrome.action.onClicked.addListener(async t=>{t.id&&await chrome.sidePanel.open({tabId:t.id})});chrome.runtime.onMessage.addListener((t,e,r)=>(s(t,e,r),!0));async function s(t,e,r){try{switch(t.type){case"CAPTURE_SCREENSHOT":const a=await chrome.tabs.captureVisibleTab();r({success:!0,dataUrl:a});break;default:r({error:"Unknown message type"})}}catch{r({error:"Error processing message"})}}n();
